
var movies = [
    {
        id: 1,
        title: "تایتانیک",
        year: 1997,
        rating: 7.9,
        genre: "رمانتیک",
        poster: "../images/picture/feature/1.jpg",
        director: "جیمز کامرون",
        cast: ["لئوناردو دی‌کاپریو", "کیت وینسلت", "بیلی زین"],
        plot: "یک جویندهٔ گنج به نام «بروک لاوت» که به دنبال الماس مشهوری به نام قلب اقیانوس در بقایای کشتی غرق شده تایتانیک است، صندوقچه‌ای در کشتی پیدا می‌کند که در آن نقاشی از چهره زنی جوان با الماسی بر گردن به چشم می‌خورد. پس از نمایش نقاشی در یک برنامه تلویزیونی، خانم پیری به اسم «رز دوویت بوکیتر» ادعا می‌کند که همان زن نقاشی است. او را به محل غرق کشتی می‌برند تا به جستجوگران کمک کند جای الماس را پیدا کنند، اما به جای این کار او داستان غرق شدن کشتی تایتانیک را برای همه آنگونه که خود از نزدیک دیده‌ بازگو می‌کند.",
        runtime: "۱۹۵ دقیقه",
        language: "	انگلیسی",
        country: "	ایالات متحده"
    },
    {
        id: 2,
        title: "چگونه اژدهای خود را تربیت کنیم",
        year: 2025,
        rating: 7.9,
        genre: "انیمیشن",
        poster: "../images/picture/feature/2.jpg",
        director: "	دین دبلوا",
        cast: ["میسون تیمز", "نیکو پارکر", "گابریل هاول"],
        plot: "اژدهاها به‌طور مداوم به روستای وایکینگی «برک» حمله می‌کنند، دام‌ها را می‌دزدند و جان اهالی را به خطر می‌اندازند. هیکاپ هورنِندس هدُک سوم، پسر شانزده‌سالهٔ رئیس قبیله استویک بزرگ، سعی دارد با اختراعات مکانیکی ضعف‌های جسمی‌اش را جبران کند. در یکی از حمله‌ها، هیکاپ با پرتاب‌گر بولاس، یک اژدهای نادر به نام نایت فیوری را هدف قرار می‌دهد، اما کسی حرفش را باور نمی‌کند. او برای اثبات خودش، به‌دنبال اژدها می‌رود تا آن را بکشد؛ ولی وقتی موجود زخمی و ناتوان را می‌بیند، با دلسوزی او را آزاد می‌کند. شگفت‌زده می‌شود وقتی می‌بیند اژدها جانش را می‌بخشد.",
        runtime: "	۱۲۵ دقیقه",
        language: "انگلیسی",
        country: "ایالات متحده"
    },
    {
        id: 3,
        title: "ددپول و ولورین",
        year: 2024,
        rating: 7.5,
        genre: "اکشن/کمدی",
        poster: "../images/picture/feature/3.jpg",
        director: "	شاون لوی ",
        cast: ["رایان رینولدز", "هیو جکمن", "اما کورین"],
        plot: "فیلم با نبش قبر ولورین توسط وید ویلسون (ددپول) آغاز می‌شود. ددپول معتقد است که ولورین هنوز زنده است، اما زمانی که اسکلت ولورین را می‌بیند به مرگ او یقین پیدا می‌کند. در این هنگام مأموران «سازمان تناقضات زمانی» (TVA) برای دستگیری او سر می‌رسند، در میانه مبارزه ددپول با آنها، داستان به سال ۲۰۱۸ بازمی‌گردد.",
        runtime: "	۱۲۸ دقیقه",
        language: "انگلیسی",
        country: "ایالات متحده"
    },
    {
        id: 4,
        title: "بازگشت به تاریکی",
        year: 2024,
        rating: 6.3,
        genre: "درام",
        poster: "../images/picture/feature/4.jpg",
        director: "	سم تیلور-جانسون",
        cast: ["ماریسا آبلا", " جک اوکانل", "ادی مارسن "],
        plot: "فیلم بازگشت به تاریکی داستان زندگی «اِیمی واینهاوس»، خواننده‌ی بریتانیایی با صدایی منحصربه‌فرد و پرقدرت را روایت می‌کند. این فیلم مسیر او را از شروع در محله‌ی زادگاهش، تا رسیدن به شهرت جهانی دنبال می‌کند؛ در حالی‌که بر ترانه‌های شخصی و پر احساسش، عشق‌های پر فراز و نشیب و چالش‌های سنگین شهرت و اعتیاد تمرکز دارد. Back to Black تصویری نزدیک و انسانی از دختری نشان می‌دهد که موسیقی‌اش جاودانه شد، اما زندگی‌اش بسیار کوتاه بود.",
        runtime: "	۱۲۲ دقیقه",
        language: " انگلیسی",
        country: "ایالات متحده/بریتانیا "
    },
    {
        id: 5,
        title: "شهراشباح",
        year: 2001,
        rating: 8.6,
        genre: "انیمیشن",
        poster: "../images/picture/feature/5.jpg",
        director: "	هایائو میازاکی",
        cast: ["رومی هیراگی ", " میو ایرینو ", "ماری ناتسوکی"],
        plot: "وقتی چیهیروی ۱۰ ساله به همراه پدر و مادرش برای زندگی از شهری به شهر دیگر می‌رود، ابتدا هیچ چیز به مذاقش خوش نمی‌آید و همه چیز از جمله مدرسه جدیدش برایش احساس تازگی ناخوشایندی دارد ، در راه خانه‌ جدید، چیهیرو و پدر و مادرش برحسب اتفاق به چیزی شبیه بازارچه برخورد می‌کنند اما غافل از اینکه آنجا یک بازارچه معمولی نیست و همین که هیچ کس در آنجا حضور ندارد به اهمیت مشکوک بودن آن قضیه می افزاید. پدر و مادر چیهیرو با دیدن غذاهای لذیذی که در غرفه های بازار وجود دارد هَوَس می‌کنند طعم آنها را بچشند و خیلی زود شروع به پرخوری می‌کنند ، از آنجایی که چیهیرو از اول احساس خوبی نسبت به آنجا نداشته به اصرار پدر و مادرش در مورد مزه کردن غذاها اهمیتی نمی‌دهد و اصرار می‌کند رفتارشان را تمام کنند و به راهشان ادامه دهند اما.....",
        runtime: " 	۱۲۵ دقیقه",
        language: "ژاپنی",
        country: "ژاپن "
    },
    {
        id: 6,
        title: "دیوار به دیوار",
        year: 2025,
        rating: 5.9,
        genre: "درام",
        poster: "../images/picture/feature/6.jpg",
        director: "کیم ته-جون ",
        cast: [" کانگ هانول", "یئوم هی ران", "سئو هیون وو"],
        plot: "وو-سئونگ، مردی که بالاخره به اندازه کافی پول پس‌انداز می‌کند تا یک آپارتمان بخرد، اما این خرید به کابوسی با ورشکستگی مالی و صداهای مرموز از طبقات همسایه تبدیل می‌شود.",
        runtime: "۱۱۸ دقیقه",
        language: "کره ای",
        country: " کره جنوبی"
    },
    {
        id: 7,
        title: "علاءالدین",
        year: 2019,
        rating: 6.9,
        genre: "رمانتیک/انیمیشن",
        poster: "../images/picture/feature/7.jpg",
        director: " 	گای ریچی",
        cast: ["	ویل اسمیت", "مینا مسعود", "ائومی اسکات"],
        plot: "در شهر خیالی اَغربه (الهام‌گرفته از بغداد و نامی ساخته‌شده با برخی حروف کلمه بغداد)، پسری یتیم و دوره‌گرد به نام علاءالدین به همراه میمونش، ابو، با شاهدخت یاسمین آشنا می‌شود که از زندگی محدودش در کاخ گریخته است. یاسمین می‌خواهد جانشین پدرش، سلطان، شود، اما انتظار می‌رود با یکی از خواستگاران سلطنتی ازدواج کند.",
        runtime: "	۱۲۸ دقیقه",
        language: "انگلیسی",
        country: " ایالات متحده"
    },
    {
        id: 8,
        title: "جان ویک",
        year: 2014,
        rating: 7.5,
        genre: "اکشن",
        poster: "../images/picture/feature/8.jpg",
        director: "	چاد استاهلسکی",
        cast: ["کیانو ریوز", "مایکل نیکویست", "Jآلفی آلن"],
        plot: "جان ویک در غم مرگ همسرش هلن به دلیل بیماری است. به‌منظور کمک به او برای کنار آمدن با غم، همسرش تصمیم گرفت بعد از مرگش توله سگی از نژاد بیگل به او اهدا کند. چند روز بعد، جان در یک پمپ بنزین در خارج از شهر نیویورک توسط گروهی از گانگسترهای روسی به رهبری یوسف مواجه می‌شود. یوسف نمی‌توانند جان را بترساند تا باس ۴۲۹ ماستنگ مدل ۱۹۶۹ خود را بفروشد.",
        runtime: "	۱۰۱ دقیقه",
        language: "	انگلیسی",
        country: "	ایالات متحده"
    },
    {
        id: 9,
        title: "آواتار(اخرین بادافزار)",
        year: 2008,
        rating: 9.3,
        genre: "اکشن",
        poster: "../images/picture/feature/9.jpg",
        director: "	لورن مک‌مولن",
        cast: ["	زک تایلر آیزن", "	زک تایلر آیزن","دانته باسکو"],
        plot: "جهان این داستان به چهار بخش اصلی تقسیم شده‌است که دربرگیرندهٔ قبایل آب، پادشاهی خاک، کشور آتش و کوچ‌نشینان باد است. در این سرزمین‌ها برخی از مردم می‌توانند عنصر ملی خود را کنترل کنند و به «اَفزارِش» درآورند که به آنها «عنصر افزار» گفته می‌شود. روش نبرد هر ملت برگرفته از یک سبک رزمی شرقی است. در این میان یک نفر که آواتار نامیده می‌شود، می‌تواند هر چهار عنصر را بیافزارد و مسئول برقراری صلح و توازن میان ملت‌ها و همچنین میان جهان فیزیکی و جهان ارواح است. ",
        runtime: "	۲۲ دقیقه",
        language: "انگلیسی",
        country: "ایالات متحده"
    },
    {
        id: 10,
        title: "مردان ایکس",
        year: 2003,
        rating: 7.4,
        genre: "اکشن/علمی تخیلی",
        poster: "../images/picture/feature/10.jpg",
        director: "	برایان سینگر",
        cast: ["	هیو جکمن", "پاتریک استوارت","ایان مک‌کلن"],
        plot: "در کاخ سفید، نایت‌کراولر، جهش‌یافته‌ای با توانایی تله‌پورت که شست‌وشوی مغزی شده، به رئیس‌جمهور ایالات متحده حمله می‌کند و چند مأمور را زخمی می‌سازد؛ اما پس از اصابت گلوله عقب‌نشینی می‌کند. در همین حال، لوگان در حال جست‌وجوی گذشته‌اش به پایگاه نظامی متروکه‌ای در کنار دریاچه آلکالی در آلبرتا می‌رود، اما چیزی نمی‌یابد. جین گری دچار پیش‌آگاهی‌هایی شده و تمرکز کردن برایش دشوار است، زیرا توانایی‌هایش روزبه‌روز از کنترلش خارج می‌شوند.",
        runtime: "	۱۳۳ دقیقه",
        language: "انگلیسی",
        country: "ایالات متحده"
    }
];

var topRatedMovies = [
    {
        id: 101,
        title: "رستگاری در شاوشنک ",
        year: 1994,
        rating: 9.3,
        genre: "اکشن/درام",
        poster: "../images/picture/top/1.jpg",
        director: "	فرانک دارابونت ",
        cast: [" تیم رابینز", " مورگان فریمن", "باب گانتون "],
        plot: "اندی دافرین، یک بانکدار آرام و باهوش، به‌اشتباه به جرم قتل همسرش و معشوقه‌ی او به حبس ابد در زندان شاوشنک محکوم می‌شود. در زندان، او با شرایط سخت، خشونت و فساد مأموران و زندانیان روبه‌رو می‌شود، اما به‌جای تسلیم شدن، با ذهن خلاق و اراده‌ی قوی خود راهی برای معنا دادن به زندگی پیدا می‌کند.او به‌تدریج با زندانی‌ای به نام رد (مورگان فریمن) دوست می‌شود.",
        runtime: "۱۴۲ دقیقه",
        language: "انگلیسی",
        country: "ایالات متحده"
    },
    {
        id: 102,
        title: "1پدر خوانده",
        year: 1972,
        rating: 9.2,
        genre: "درام/اکشن",
        poster: "../images/picture/top/2.jpg",
        director: "استیون اسپیلبرگ",
        cast: ["لیام نیسون", "بن کینگزلی", "رالف فاینز"],
        plot: "داستان واقعی اسکار شیندلر که در طول جنگ جهانی دوم جان بیش از 1000 یهودی را نجات داد.",
        runtime: "۱۹۵ دقیقه",
        language: "انگلیسی",
        country: "ایالات متحده"
    },
    {
        id: 103,
        title: "شوالیه تاریکی",
        year: 2008,
        rating: 9.1,
        genre:"اکشن" ,
        poster: "../images/picture/top/3.jpg",
        director: "فرانسیس فورد کوپولا",
        cast: ["مارلون براندو", "آل پاچینو", "جیمز کان"],
        plot: "داستان خانواده کورلئونه و دنیای مافیای نیویورک در دهه 1940.",
        runtime: "۱۷۵ دقیقه",
        language: "انگلیسی",
        country: "ایالات متحده"
    },
    {
        id: 104,
        title: "پدر خوانده 2",
        year: 1974,
        rating: 9.0,
        genre: "درام/اکشن",
        poster: "../images/picture/top/4.jpg",
        director: "رابرت زمکیس",
        cast: ["تام هنکس", "رابین رایت", "گری سینیز"],
        plot: "داستان زندگی فارست گامپ، مردی با ضریب هوشی پایین که در رویدادهای مهم تاریخ آمریکا حضور داشته.",
        runtime: "۱۴۲ دقیقه",
        language: "انگلیسی",
        country: "ایالات متحده"
    },
    {
        id: 105,
        title: "دوازده مرد خشمگین",
        year: 1957,
        rating: 9.0,
        genre: "اکشن/درام",
        poster: "../images/picture/top/5.jpg",
        director: "کوئنتین تارانتینو",
        cast: ["جان تراولتا", "ساموئل ال. جکسون", "اوما تورمن"],
        plot: "چندین داستان به هم پیوسته در دنیای جنایتکاران لس آنجلس.",
        runtime: "۱۵۴ دقیقه",
        language: "انگلیسی",
        country: "ایالات متحده"
    },
    {
        id: 106,
        title: "ارباب حلقه ها (بازگشت پادشاه)",
        year: 2004,
        rating: 9.0,
        genre: "درام/انیمیشن",
        poster: "../images/picture/top/6.jpg",
        director: "استنلی کوبریک",
        cast: ["جک نیکلسون", "شلی دووال", "دنی لوید"],
        plot: "خانواده‌ای که در هتلی دورافتاده نگهبان می‌شوند و با نیروهای شیطانی مواجه می‌شوند.",
        runtime: "۱۴۶ دقیقه",
        language: "انگلیسی",
        country: "ایالات متحده"
    },
    {
        id: 107,
        title: "داستان عامه پسند",
        year: 1994,
        rating: 8.8,
        genre: "اکشن",
        poster: "../images/picture/top/7.jpg",
        director: "واچوفسکی‌ها",
        cast: ["کیانو ریوز", "لارنس فیشبرن", "کری-آن ماس"],
        plot: "هکر جوانی که متوجه می‌شود دنیای واقعی در واقع شبیه‌سازی کامپیوتری است.",
        runtime: "۱۳۶ دقیقه",
        language: "انگلیسی",
        country: "ایالات متحده"
    },
    {
        id: 108,
        title: "فهرست شیندرلر",
        year: 1993,
        rating: 9.0,
        genre: "اگشن/درام",
        poster: "../images/picture/top/8.jpg",
        director: "فرناندو میرلس",
        cast: ["الکس رودریگز", "لیندر فیلو", "په له هاج"],
        plot: "داستان زندگی در فاولاهای ریو دو ژانیرو و رشد جنایت در آنجا.",
        runtime: "۱۳۰ دقیقه",
        language: "پرتغالی",
        country: "برزیل"
    },
    {
        id: 109,
        title: "ارباب حلقه ها (دنبال کنندگان حلقه)",
        year: 2001,
        rating: 8.9,
        genre: "درام/رمانتیک",
        poster: "../images/picture/top/9.jpg",
        director: "راب مارشال",
        cast: ["ژانگ زی‌یی", "کن واتانابه", "میشل یئو"],
        plot: "داستان زندگی یک گیشا در ژاپن قبل و بعد از جنگ جهانی دوم.",
        runtime: "۱۴۵ دقیقه",
        language: "انگلیسی",
        country: "ایالات متحده"
    },
    {
        id: 110,
        title: "خوب بد زشت",
        year: 1996,
        rating: 8.8,
        genre: "اکشن",
        poster: "../images/picture/top/10.jpg",
        director: "جیمز کامرون",
        cast: ["سم ورثینگتون", "زوئی سالدانا", "سیگورنی ویور"],
        plot: "سرباز معلولی که در مأموریتی به سیاره پاندورا می‌رود و با ساکنان آنجا ارتباط برقرار می‌کند.",
        runtime: "۱۶۲ دقیقه",
        language: "انگلیسی",
        country: "ایالات متحده"
    }
];

// Top Rated Series
var topRatedSeries = [
    {
        id: 201,
        title: "بازی تاج و تخت",
        year: 2011,
        rating: 9.2,
        genre: "درام/فانتزی",
        poster: "../images/picture/series/1.jpg",
        director: "مت گایدد",
        cast: ["کتیلین استارک", "جان اسنو", "دنریس تارگرین"],
        plot: "نبرد خاندان‌ها برای تصاحب تاج و تخت آهنین در وستروس.",
        runtime: "۵۷ دقیقه",
        language: "انگلیسی",
        country: "ایالات متحده/بریتانیا"
    },
    {
        id: 202,
        title: "شرلوک",
        year: 2010,
        rating: 9.1,
        genre: "معمایی/جنایی",
        poster: "../images/picture/series/2.jpg",
        director: "پل مک‌گیگان",
        cast: ["بندیکت کامبربچ", "مارتین فریمن"],
        plot: "بازآفرینی مدرن ماجراهای شرلوک هلمز در لندن معاصر.",
        runtime: "۹۰ دقیقه",
        language: "انگلیسی",
        country: "بریتانیا"
    },
    {
        id: 203,
        title: "خانه کاغذی",
        year: 2017,
        rating: 8.2,
        genre: "اکشن/هیجان‌انگیز",
        poster: "../images/picture/series/3.jpg",
        director: "الکس پینا",
        cast: ["ال پروفوسور", "توکیو", "برلین"],
        plot: "برنامه‌ریزی دقیق گروهی برای بزرگترین سرقت‌ها در اسپانیا.",
        runtime: "۵۰ دقیقه",
        language: "اسپانیایی",
        country: "اسپانیا"
    },
    {
        id: 204,
        title: "چیزهای عجیب",
        year: 2016,
        rating: 8.7,
        genre: "علمی‌تخیلی/ترسناک",
        poster: "../images/picture/series/4.jpg",
        director: "برادران دافر",
        cast: ["الیون", "مایک", "داستان هاربر"],
        plot: "رخدادهای مرموز در شهری کوچک و دنیایی وارونه.",
        runtime: "۵۵ دقیقه",
        language: "انگلیسی",
        country: "ایالات متحده"
    },
    {
        id: 205,
        title: "وایکینگ‌ها",
        year: 2013,
        rating: 8.5,
        genre: "تاریخی/اکشن",
        poster: "../images/picture/series/5.jpg",
        director: "مایکل هرست",
        cast: ["راگنار", "لاگرتا", "رولو"],
        plot: "افسانه راگنار لاثبروک و ماجراجویی‌های وایکینگ‌ها.",
        runtime: "۴۵ دقیقه",
        language: "انگلیسی",
        country: "ایرلند/کانادا"
    },
    {
        id: 206,
        title: "برکینگ بد",
        year: 2008,
        rating: 9.5,
        genre: "درام/جنایی",
        poster: "../images/picture/series/6.jpg",
        director: "وینس گیلیگان",
        cast: ["والتر وایت", "جسی پینکمن"],
        plot: "معلم شیمی که برای تامین خانواده‌اش به دنیای جرم قدم می‌گذارد.",
        runtime: "۴۷ دقیقه",
        language: "انگلیسی",
        country: "ایالات متحده"
    },
    {
        id: 207,
        title: "برکینگ بد",
        year: 2008,
        rating: 9.5,
        genre: "درام/جنایی",
        poster: "../images/picture/series/6.jpg",
        director: "وینس گیلیگان",
        cast: ["والتر وایت", "جسی پینکمن"],
        plot: "معلم شیمی که برای تامین خانواده‌اش به دنیای جرم قدم می‌گذارد.",
        runtime: "۴۷ دقیقه",
        language: "انگلیسی",
        country: "ایالات متحده"
    },
    {
        id: 208,
        title: "برکینگ بد",
        year: 2008,
        rating: 9.5,
        genre: "درام/جنایی",
        poster: "../images/picture/series/6.jpg",
        director: "وینس گیلیگان",
        cast: ["والتر وایت", "جسی پینکمن"],
        plot: "معلم شیمی که برای تامین خانواده‌اش به دنیای جرم قدم می‌گذارد.",
        runtime: "۴۷ دقیقه",
        language: "انگلیسی",
        country: "ایالات متحده"
    },
    {
        id: 209,
        title: "برکینگ بد",
        year: 2008,
        rating: 9.5,
        genre: "درام/جنایی",
        poster: "../images/picture/series/6.jpg",
        director: "وینس گیلیگان",
        cast: ["والتر وایت", "جسی پینکمن"],
        plot: "معلم شیمی که برای تامین خانواده‌اش به دنیای جرم قدم می‌گذارد.",
        runtime: "۴۷ دقیقه",
        language: "انگلیسی",
        country: "ایالات متحده"
    },
    {
        id: 210,
        title: "برکینگ بد",
        year: 2008,
        rating: 9.5,
        genre: "درام/جنایی",
        poster: "../images/picture/series/6.jpg",
        director: "وینس گیلیگان",
        cast: ["والتر وایت", "جسی پینکمن"],
        plot: "معلم شیمی که برای تامین خانواده‌اش به دنیای جرم قدم می‌گذارد.",
        runtime: "۴۷ دقیقه",
        language: "انگلیسی",
        country: "ایالات متحده"
    },
];

var featuredMoviesContainer = document.getElementById('featuredMovies');
var topRatedMoviesContainer = document.getElementById('topRatedMovies');
var topRatedSeriesContainer = document.getElementById('topRatedSeries');
var searchInput = document.getElementById('searchInput');
var searchBtn = document.getElementById('searchBtn');
var movieModal = document.getElementById('movieModal');
var movieDetails = document.getElementById('movieDetails');
var closeModal = document.querySelector('.close');
var categoryCards = document.querySelectorAll('.category-card');

document.addEventListener('DOMContentLoaded', function () {
    loadFeaturedMovies();
    loadTopRatedMovies();
    loadTopRatedSeries();
    setupEventListeners();
    setupNavigation();
    setupSliders();
});

//FeaturedMovies
function loadFeaturedMovies() {
    var featuredMovies = movies.slice(0, 10);
    featuredMoviesContainer.innerHTML = featuredMovies.map(movie => createMovieCard(movie)).join('');
}

//toprated
function loadTopRatedMovies() {
    // استفاده از آرایه جداگانه برای Top Rated Movies
    var topRatedHTML = '';
    
    // لوپ جداگانه برای Top Rated Movies
    for (var i = 0; i < topRatedMovies.length; i++) {
        var movie = topRatedMovies[i];
        topRatedHTML += createMovieCard(movie);
    }
    
    topRatedMoviesContainer.innerHTML = topRatedHTML;
}

// Top Rated Series
function loadTopRatedSeries() {
    var seriesHTML = '';
    for (var i = 0; i < topRatedSeries.length; i++) {
        var show = topRatedSeries[i];
        seriesHTML += createMovieCard(show);
    }
    if (topRatedSeriesContainer) {
        topRatedSeriesContainer.innerHTML = seriesHTML;
    }
}

// Create Movie Card HTML with new structure
function createMovieCard(movie) {
    return `
        <div class="movie-card" data-movie-id="${movie.id}">
            <div class="poster">
                <img src="${movie.poster}" alt="${movie.title}">
            </div>
            <div class="movie-info">
                <div class="rating">
                    <span class="star">★</span>
                    <span class="score">${movie.rating}</span>
                </div>
                <h3 class="title">${movie.title}</h3>
                <div class="genre-tag">${movie.genre}</div>
                <div class="buttons">
                    <button class="watchlist" data-action="watchlist">+ لیست تماشا</button>
                    <button class="trailer" data-action="trailer" data-movie-id="${movie.id}">▶ پیش‌نمایش</button>
                </div>
            </div>
        </div>
    `;
}

// Slider setup and controls
function setupSliders() {
    var sliders = document.querySelectorAll('.slider');
    sliders.forEach(slider => {
        var track = slider.querySelector('.slider-track');
        var prevBtn = slider.querySelector('.slider-btn.prev');
        var nextBtn = slider.querySelector('.slider-btn.next');

        var getCardWidth = () => {
            var firstCard = track.querySelector('.movie-card');
            if (!firstCard) return 300;
            var style = window.getComputedStyle(firstCard);
            var width = firstCard.getBoundingClientRect().width;
            var marginRight = parseFloat(style.marginRight || '0');
            return width + marginRight;
        };

        var scrollByCards = (count) => {
            var amount = getCardWidth() * count;
            track.scrollBy({ left: amount, behavior: 'smooth' });
        };

        if (prevBtn) prevBtn.addEventListener('click', () => scrollByCards(-1));
        if (nextBtn) nextBtn.addEventListener('click', () => scrollByCards(1));

        // Keyboard support
        slider.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowLeft') scrollByCards(-1);
            if (e.key === 'ArrowRight') scrollByCards(1);
        });

        // Make slider focusable for a11y
        slider.setAttribute('tabindex', '0');

        // Lazy load images
        const lazyImages = Array.from(track.querySelectorAll('img'));
        lazyImages.forEach(img => {
            img.loading = 'lazy';
            img.addEventListener('error', () => {
                const placeholder = document.createElement('div');
                placeholder.className = 'movie-poster placeholder-poster';
                placeholder.textContent = 'Place image here';
                img.replaceWith(placeholder);
            });
        });
    });
}

// Setup Event Listeners
function setupEventListeners() {
    // Movie card clicks (for modal)
    document.addEventListener('click', function (e) {
        const movieCard = e.target.closest('.movie-card');
        if (movieCard) {
            // prevent modal open on button clicks
            const button = e.target.closest('button');
            if (button) return;

            const movieId = parseInt(movieCard.dataset.movieId);
            // جستجو در هر دو آرایه
            var movie = movies.find(m => m.id === movieId) ||
                        topRatedMovies.find(m => m.id === movieId) ||
                        topRatedSeries.find(m => m.id === movieId);
            if (movie) {
                showMovieDetails(movie);
            }
        }
    });

    // Search functionality
    searchBtn.addEventListener('click', performSearch);
    searchInput.addEventListener('keypress', function (e) {
        if (e.key === 'Enter') {
            performSearch();
        }
    });

    // Modal close
    if (closeModal) closeModal.addEventListener('click', closeMovieModal);
    if (movieModal) {
        movieModal.addEventListener('click', function (e) {
            if (e.target === movieModal) {
                closeMovieModal();
            }
        });
    }

    // Category cards
    categoryCards.forEach(card => {
        card.addEventListener('click', function () {
            const genre = this.dataset.genre;
            filterMoviesByGenre(genre);
        });
    });

    // Hero buttons
    const primaryBtn = document.querySelector('.btn-primary');
    if (primaryBtn) {
        primaryBtn.addEventListener('click', function () {
            const target = document.querySelector('.featured-section');
            if (target) target.scrollIntoView({ behavior: 'smooth' });
        });
    }

    const secondaryBtn = document.querySelector('.btn-secondary');
    if (secondaryBtn) {
        secondaryBtn.addEventListener('click', function () {
            alert('امکان پیش‌نمایش به‌زودی اضافه می‌شود!');
        });
    }

    // Watchlist, trailer, and add button actions
    document.addEventListener('click', function (e) {
        const btn = e.target.closest('button, .add-icon');
        if (!btn) return;

        const card = e.target.closest('.movie-card');
        if (!card) return;

        const movieId = parseInt(card.dataset.movieId);
        const movie = movies.find(m => m.id === movieId) ||
                      topRatedMovies.find(m => m.id === movieId) ||
                      topRatedSeries.find(m => m.id === movieId);
        if (!movie) return;

        const action = btn.dataset.action;

        if (action === 'watchlist') {
            btn.classList.toggle('active');
            if (btn.classList.contains('active')) {
                btn.textContent = '✓ در لیست تماشا';
            } else {
                btn.textContent = '+ لیست تماشا';
            }
        }

        if (action === 'trailer') {
            // Navigate to trailer page
            window.location.href = `trailer.html?movie=${movieId}`;
        }

        if (action === 'add') {
            btn.textContent = btn.textContent === '+' ? '✓' : '+';
        }
    });
}

// Show Movie Details Modal
function showMovieDetails(movie) {
    const stars = '★'.repeat(Math.floor(movie.rating)) + '☆'.repeat(5 - Math.floor(movie.rating));

    movieDetails.innerHTML = `
        <div class="movie-detail">
            <img src="${movie.poster}" alt="${movie.title}" class="movie-detail-poster">
            <div class="movie-detail-info">
                <h2>${movie.title} (${movie.year})</h2>
                <div class="movie-rating">
                    <span class="rating-star">${stars}</span>
                    <span class="rating-value">${movie.rating}/10</span>
                </div>
                <div class="movie-stats">
                    <div class="stat">
                        <div class="stat-value">${movie.runtime}</div>
                        <div class="stat-label">Runtime</div>
                    </div>
                    <div class="stat">
                        <div class="stat-value">${movie.genre}</div>
                        <div class="stat-label">Genre</div>
                    </div>
                    <div class="stat">
                        <div class="stat-value">${movie.language}</div>
                        <div class="stat-label">Language</div>
                    </div>
                </div>
                <p><strong>Director:</strong> ${movie.director}</p>
                <p><strong>Cast:</strong> ${movie.cast.join(', ')}</p>
                <p><strong>Country:</strong> ${movie.country}</p>
                <p><strong>Plot:</strong> ${movie.plot}</p>
            </div>
        </div>
    `;

    movieModal.style.display = 'block';
    document.body.style.overflow = 'hidden';
}

// Close Movie Modal
function closeMovieModal() {
    movieModal.style.display = 'none';
    document.body.style.overflow = 'auto';
}

// Search Functionality
function performSearch() {
    const searchTerm = searchInput.value.toLowerCase().trim();
    if (searchTerm === '') return;

    // جستجو در هر دو آرایه
    const results = [...movies, ...topRatedMovies, ...topRatedSeries].filter(movie =>
        movie.title.toLowerCase().includes(searchTerm) ||
        movie.director.toLowerCase().includes(searchTerm) ||
        movie.cast.some(actor => actor.toLowerCase().includes(searchTerm)) ||
        movie.genre.toLowerCase().includes(searchTerm)
    );

    if (results.length > 0) {
        showSearchResults(results);
    } else {
        showNoResults();
    }
}

// Show Search Results
function showSearchResults(results) {
    const searchSection = document.createElement('section');
    searchSection.className = 'search-results-section';
    searchSection.style.background = '#1a1a1a';
    searchSection.style.padding = '4rem 0';

    searchSection.innerHTML = `
        <div class="container">
            <h2>Search Results for "${searchInput.value}"</h2>
            <div class="movie-grid">
                ${results.map(movie => createMovieCard(movie)).join('')}
            </div>
        </div>
    `;

    // Remove existing search results
    const existingResults = document.querySelector('.search-results-section');
    if (existingResults) {
        existingResults.remove();
    }

    // Insert after hero section
    const hero = document.querySelector('.hero');
    hero.parentNode.insertBefore(searchSection, hero.nextSibling);

    // Scroll to results
    searchSection.scrollIntoView({ behavior: 'smooth' });
}

// Show No Results
function showNoResults() {
    const searchSection = document.createElement('section');
    searchSection.className = 'search-results-section';
    searchSection.style.background = '#1a1a1a';
    searchSection.style.padding = '4rem 0';

    searchSection.innerHTML = `
        <div class="container">
            <h2>No results found for "${searchInput.value}"</h2>
            <p style="text-align: center; color: #999; font-size: 1.1rem;">
                Try searching for a different movie, director, or actor.
            </p>
        </div>
    `;

    // Remove existing search results
    const existingResults = document.querySelector('.search-results-section');
    if (existingResults) {
        existingResults.remove();
    }

    // Insert after hero section
    const hero = document.querySelector('.hero');
    hero.parentNode.insertBefore(searchSection, hero.nextSibling);

    // Scroll to results
    searchSection.scrollIntoView({ behavior: 'smooth' });
}

// Filter Movies by Genre
function filterMoviesByGenre(genre) {
    // فیلتر کردن از هر دو آرایه
    const filteredMovies = [...movies, ...topRatedMovies, ...topRatedSeries].filter(movie =>
        movie.genre.toLowerCase() === genre.toLowerCase()
    );

    if (filteredMovies.length > 0) {
        showGenreResults(genre, filteredMovies);
    } else {
        showNoGenreResults(genre);
    }
}

// Show Genre Results
function showGenreResults(genre, results) {
    const genreSection = document.createElement('section');
    genreSection.className = 'genre-results-section';
    genreSection.style.background = '#2d2d2d';
    genreSection.style.padding = '4rem 0';

    genreSection.innerHTML = `
        <div class="container">
            <h2>${genre.charAt(0).toUpperCase() + genre.slice(1)} Movies</h2>
            <div class="movie-grid">
                ${results.map(movie => createMovieCard(movie)).join('')}
            </div>
        </div>
    `;

    // Remove existing genre results
    const existingResults = document.querySelector('.genre-results-section');
    if (existingResults) {
        existingResults.remove();
    }

    // Insert after hero section
    const hero = document.querySelector('.hero');
    hero.parentNode.insertBefore(genreSection, hero.nextSibling);

    // Scroll to results
    genreSection.scrollIntoView({ behavior: 'smooth' });
}

// Show No Genre Results
function showNoGenreResults(genre) {
    const genreSection = document.createElement('section');
    genreSection.className = 'genre-results-section';
    genreSection.style.background = '#2d2d2d';
    genreSection.style.padding = '4rem 0';

    genreSection.innerHTML = `
        <div class="container">
            <h2>No ${genre} movies found</h2>
            <p style="text-align: center; color: #999; font-size: 1.1rem;">
                We're working on adding more ${genre} movies to our database.
            </p>
        </div>
    `;

    // Remove existing genre results
    const existingResults = document.querySelector('.genre-results-section');
    if (existingResults) {
        existingResults.remove();
    }

    // Insert after hero section
    const hero = document.querySelector('.hero');
    hero.parentNode.insertBefore(genreSection, hero.nextSibling);

    // Scroll to results
    genreSection.scrollIntoView({ behavior: 'smooth' });
}

// Setup Navigation
function setupNavigation() {
    const navLinks = document.querySelectorAll('.nav-link');
    const navToggle = document.querySelector('.nav-toggle');
    const navMenu = document.querySelector('.nav-menu');

    // Smooth scrolling for navigation links
    navLinks.forEach(link => {
        link.addEventListener('click', function (e) {
            e.preventDefault();
            const targetId = this.getAttribute('href').substring(1);
            const targetSection = document.getElementById(targetId);

            if (targetSection) {
                targetSection.scrollIntoView({ behavior: 'smooth' });
            }

            // Update active link
            navLinks.forEach(l => l.classList.remove('active'));
            this.classList.add('active');
        });
    });

    // Mobile menu toggle
    if (navToggle) {
        navToggle.addEventListener('click', function () {
            navMenu.classList.toggle('active');
            navToggle.classList.toggle('active');
        });
    }

    // Close mobile menu when clicking outside
    document.addEventListener('click', function (e) {
        if (!e.target.closest('.nav-menu') && !e.target.closest('.nav-toggle')) {
            navMenu.classList.remove('active');
            navToggle.classList.remove('active');
        }
    });
}

// Add some CSS for mobile menu
const mobileMenuCSS = `
    @media (max-width: 768px) {
        .nav-menu {
            position: fixed;
            top: 100%;
            left: 0;
            width: 100%;
            background: #1a1a1a;
            flex-direction: column;
            padding: 2rem;
            transform: translateY(-100%);
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        
        .nav-menu.active {
            transform: translateY(0);
            opacity: 1;
            visibility: visible;
        }
        
        .nav-toggle.active span:nth-child(1) {
            transform: rotate(45deg) translate(5px, 5px);
        }
        
        .nav-toggle.active span:nth-child(2) {
            opacity: 0;
        }
        
        .nav-toggle.active span:nth-child(3) {
            transform: rotate(-45deg) translate(7px, -6px);
        }
    }
`;

// Inject mobile menu CSS
const style = document.createElement('style');
style.textContent = mobileMenuCSS;
document.head.appendChild(style);

// Add loading animation
function showLoading(container) {
    container.innerHTML = '<div class="loading"></div>';
}

// Add some interactive features
document.addEventListener('DOMContentLoaded', function () {
    // Add scroll effect to navbar
    window.addEventListener('scroll', function () {
        const navbar = document.querySelector('.navbar');
        if (window.scrollY > 100) {
            navbar.style.background = 'rgba(26, 26, 26, 0.95)';
            navbar.style.backdropFilter = 'blur(10px)';
        } else {
            navbar.style.background = 'linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%)';
            navbar.style.backdropFilter = 'none';
        }
    });

    // Add hover effects to movie cards
    const movieCards = document.querySelectorAll('.movie-card');
    movieCards.forEach(card => {
        card.addEventListener('mouseenter', function () {
            this.style.transform = 'translateY(-10px) scale(1.02)';
        });

        card.addEventListener('mouseleave', function () {
            this.style.transform = 'translateY(0) scale(1)';
        });
    });
});

// Add keyboard navigation for modal
document.addEventListener('keydown', function (e) {
    if (e.key === 'Escape' && movieModal.style.display === 'block') {
        closeMovieModal();
    }
});

// Add some sample data for demonstration
console.log('MovieDB loaded successfully!');
console.log('Available movies:', movies.length);
console.log('Features: Search, Filter by Genre, Movie Details, Responsive Design');
